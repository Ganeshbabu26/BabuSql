use babu;

CREATE TABLE ATTENDANCE (
    AID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    ID INT NOT NULL,
    ADATE DATE NOT NULL,
    ASTATUS VARCHAR(10) NOT NULL
);

DESCRIBE ATTENDANCE;

SHOW TABLES;
INSERT INTO ATTENDANCE (ID, ADATE, ASTATUS) VALUES
(1, '2025-07-26', 'A'),
(1, '2025-07-27', 'A'),
(1, '2025-07-28', 'A'),
(1, '2025-07-29', 'P'),
(2, '2025-07-26', 'P'),
(2, '2025-07-27', 'A'),
(2, '2025-07-28', 'A'),
(2, '2025-07-29', 'A'),
(3, '2025-07-26', 'A'),
(3, '2025-07-27', 'A'),
(3, '2025-07-28', 'P'),
(3, '2025-07-29', 'P'),
(4, '2025-07-26', 'P'),
(4, '2025-07-27', 'P'),
(4, '2025-07-28', 'A'),
(4, '2025-07-29', 'P'),
(5, '2025-07-26', 'A'),
(5, '2025-07-27', 'P'),
(5, '2025-07-28', 'P'),
(5, '2025-07-29', 'A'),
(6, '2025-07-26', 'A'),
(6, '2025-07-27', 'P'),
(6, '2025-07-28', 'A'),
(6, '2025-07-29', 'A'),
(7, '2025-07-26', 'A'),
(7, '2025-07-27', 'A'),
(7, '2025-07-28', 'A'),
(7, '2025-07-29', 'A'),
(8, '2025-07-26', 'A'),
(8, '2025-07-27', 'P'),
(8, '2025-07-28', 'P'),
(8, '2025-07-29', 'P'),
(9, '2025-07-26', 'A'),
(9, '2025-07-27', 'P'),
(9, '2025-07-28', 'A'),
(9, '2025-07-29', 'A'),
(10, '2025-07-26', 'P'),
(10, '2025-07-27', 'P'),
(10, '2025-07-28', 'A'),
(10, '2025-07-29', 'P'),
(11, '2025-07-26', 'A'),
(11, '2025-07-27', 'P'),
(11, '2025-07-28', 'A'),
(11, '2025-07-29', 'P'),
(12, '2025-07-26', 'A'),
(12, '2025-07-27', 'P'),
(12, '2025-07-28', 'A'),
(12, '2025-07-29', 'P'),
(13, '2025-07-26', 'P'),
(13, '2025-07-27', 'A'),
(13, '2025-07-28', 'P'),
(13, '2025-07-29', 'P'),
(14, '2025-07-26', 'P'),
(14, '2025-07-27', 'A'),
(14, '2025-07-28', 'A'),
(14, '2025-07-29', 'A'),
(15, '2025-07-26', 'P'),
(15, '2025-07-27', 'A'),
(15, '2025-07-28', 'A'),
(15, '2025-07-29', 'P'),
(16, '2025-07-26', 'P'),
(16, '2025-07-27', 'P'),
(16, '2025-07-28', 'P'),
(16, '2025-07-29', 'A'),
(17, '2025-07-26', 'P'),
(17, '2025-07-27', 'A'),
(17, '2025-07-28', 'A'),
(17, '2025-07-29', 'A'),
(18, '2025-07-26', 'A'),
(18, '2025-07-27', 'A'),
(18, '2025-07-28', 'A'),
(18, '2025-07-29', 'A'),
(19, '2025-07-26', 'A'),
(19, '2025-07-27', 'A'),
(19, '2025-07-28', 'A'),
(19, '2025-07-29', 'P'),
(20, '2025-07-26', 'A'),
(20, '2025-07-27', 'P'),
(20, '2025-07-28', 'A'),
(20, '2025-07-29', 'A'),
(21, '2025-07-26', 'P'),
(21, '2025-07-27', 'P'),
(21, '2025-07-28', 'A'),
(21, '2025-07-29', 'P'),
(22, '2025-07-26', 'A'),
(22, '2025-07-27', 'P'),
(22, '2025-07-28', 'P'),
(22, '2025-07-29', 'P'),
(23, '2025-07-26', 'A'),
(23, '2025-07-27', 'P'),
(23, '2025-07-28', 'P'),
(23, '2025-07-29', 'A'),
(24, '2025-07-26', 'A'),
(24, '2025-07-27', 'P'),
(24, '2025-07-28', 'A'),
(24, '2025-07-29', 'A'),
(25, '2025-07-26', 'P'),
(25, '2025-07-27', 'A'),
(25, '2025-07-28', 'P'),
(25, '2025-07-29', 'P'),
(26, '2025-07-26', 'P'),
(26, '2025-07-27', 'P'),
(26, '2025-07-28', 'A'),
(26, '2025-07-29', 'P'),
(27, '2025-07-26', 'P'),
(27, '2025-07-27', 'A'),
(27, '2025-07-28', 'A'),
(27, '2025-07-29', 'P'),
(28, '2025-07-26', 'P'),
(28, '2025-07-27', 'P'),
(28, '2025-07-28', 'P'),
(28, '2025-07-29', 'A'),
(29, '2025-07-26', 'A'),
(29, '2025-07-27', 'A'),
(29, '2025-07-28', 'A'),
(29, '2025-07-29', 'A'),
(30, '2025-07-26', 'A'),
(30, '2025-07-27', 'P'),
(30, '2025-07-28', 'A'),
(30, '2025-07-29', 'P'),
(31, '2025-07-26', 'P'),
(31, '2025-07-27', 'A'),
(31, '2025-07-28', 'P'),
(31, '2025-07-29', 'P'),
(32, '2025-07-26', 'P'),
(32, '2025-07-27', 'A'),
(32, '2025-07-28', 'A'),
(32, '2025-07-29', 'A'),
(33, '2025-07-26', 'P'),
(33, '2025-07-27', 'P'),
(33, '2025-07-28', 'A'),
(33, '2025-07-29', 'A'),
(34, '2025-07-26', 'P'),
(34, '2025-07-27', 'P'),
(34, '2025-07-28', 'A'),
(34, '2025-07-29', 'A'),
(35, '2025-07-26', 'P'),
(35, '2025-07-27', 'A'),
(35, '2025-07-28', 'P'),
(35, '2025-07-29', 'A'),
(36, '2025-07-26', 'A'),
(36, '2025-07-27', 'P'),
(36, '2025-07-28', 'A'),
(36, '2025-07-29', 'A'),
(37, '2025-07-26', 'P'),
(37, '2025-07-27', 'P'),
(37, '2025-07-28', 'A'),
(37, '2025-07-29', 'A'),
(38, '2025-07-26', 'A'),
(38, '2025-07-27', 'P'),
(38, '2025-07-28', 'A'),
(38, '2025-07-29', 'A'),
(39, '2025-07-26', 'P'),
(39, '2025-07-27', 'P'),
(39, '2025-07-28', 'A'),
(39, '2025-07-29', 'A'),
(40, '2025-07-26', 'A'),
(40, '2025-07-27', 'A'),
(40, '2025-07-28', 'A'),
(40, '2025-07-29', 'P'),
(41, '2025-07-26', 'A'),
(41, '2025-07-27', 'P'),
(41, '2025-07-28', 'P'),
(41, '2025-07-29', 'A'),
(42, '2025-07-26', 'A'),
(42, '2025-07-27', 'P'),
(42, '2025-07-28', 'A'),
(42, '2025-07-29', 'P'),
(43, '2025-07-26', 'A'),
(43, '2025-07-27', 'P'),
(43, '2025-07-28', 'A'),
(43, '2025-07-29', 'A'),
(44, '2025-07-26', 'A'),
(44, '2025-07-27', 'P'),
(44, '2025-07-28', 'A'),
(44, '2025-07-29', 'P'),
(45, '2025-07-26', 'A'),
(45, '2025-07-27', 'A'),
(45, '2025-07-28', 'A'),
(45, '2025-07-29', 'A'),
(46, '2025-07-26', 'A'),
(46, '2025-07-27', 'A'),
(46, '2025-07-28', 'P'),
(46, '2025-07-29', 'A'),
(47, '2025-07-26', 'P'),
(47, '2025-07-27', 'P'),
(47, '2025-07-28', 'P'),
(47, '2025-07-29', 'A'),
(48, '2025-07-26', 'A'),
(48, '2025-07-27', 'P'),
(48, '2025-07-28', 'P'),
(48, '2025-07-29', 'A'),
(49, '2025-07-26', 'P'),
(49, '2025-07-27', 'P'),
(49, '2025-07-28', 'P'),
(49, '2025-07-29', 'A'),
(50, '2025-07-26', 'A'),
(50, '2025-07-27', 'A'),
(50, '2025-07-28', 'A'),
(50, '2025-07-29', 'A'),
(51, '2025-07-26', 'P'),
(51, '2025-07-27', 'P'),
(51, '2025-07-28', 'P'),
(51, '2025-07-29', 'A');

SELECT * FROM ATTENDANCE;
SELECT * FROM ATTENDANCE WHERE ID = 1;
SELECT ID, COUNT(ADATE) AS WORKING FROM ATTENDANCE GROUP BY ID;

SELECT ID,
COUNT(ADATE) AS WORKING, 
COUNT(IF (ASTATUS = "P",1,NULL)) AS PRESENT 
FROM ATTENDANCE GROUP BY ID;

SELECT 
STUDENTS.NAME, STUDENTS.GENDER, 
ATTENDANCE.ADATE, ATTENDANCE.ASTATUS
FROM STUDENTS INNER JOIN ATTENDANCE
ON STUDENTS.ID = ATTENDANCE.ID;


SELECT NAME, CITY,
(
    CASE
        WHEN CITY='CHENNAI' THEN 300
        WHEN CITY = 'TRICHY' THEN 250
        WHEN CITY = 'MADURAI' THEN 275
        ELSE 100
    END
) AS AMOUNT FROM STUDENTS; 

SELECT NAME, CITY,
(
    CASE
        WHEN CITY='CHENNAI' THEN 300
        WHEN CITY = 'TRICHY' THEN 250
        WHEN CITY = 'MADURAI' THEN 275
        ELSE 100
    END
) AS AMOUNT FROM STUDENTS WHERE CITY IN("CHENNAI","TRICHY","MADURAI"); 